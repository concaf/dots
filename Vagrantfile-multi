module OS
    def OS.windows?
        (/cygwin|mswin|mingw|bccwin|wince|emx/ =~ RUBY_PLATFORM) != nil
    end

    def OS.mac?
        (/darwin/ =~ RUBY_PLATFORM) != nil
    end

    def OS.unix?
        !OS.windows?
    end

    def OS.linux?
        OS.unix? and not OS.mac?
    end
end

Vagrant.configure(2) do |config|
  config.vm.box = "projectatomic/adb"
  config.vm.provider :libvirt do |libvirt|
    libvirt.memory = 2048
#    libvirt.cpus = 2
    libvirt.management_network_name = 'vagrant-libvirt-new'
    libvirt.management_network_address = '192.168.124.0/24'
  end

  config.vm.provider "virtualbox" do |vbox, override|
    vbox.memory = 2048
#    vbox.cpus = 2

  # Enable use of more than one virtual CPU in a virtual machine.
    vbox.customize ["modifyvm", :id, "--ioapic", "on"]
  end

    if OS.windows?
      config.vm.provision "shell", inline: "yum makecache fast && yum install -y cifs-utils"
      config.vm.synced_folder "C:/Users/<user>/Documents/adb_mount", "/vagrant", type: "smb"
    elsif OS.linux?
      config.vm.synced_folder "/home/vagrant/saleem_setup_118", "/home/vagrant/adb_mount", type: "nfs"
    end

#  # config.sshfs.username = "user1"
#  # config.ssh.username
#  ssh_user = "vagrant"
#  # print ssh_user
#
#  # Mount a folder from HOST to GUEST
#  config.sshfs.mount_on_guest = true
#  # first path is on host, and second path is on guest
#  config.sshfs.paths = {"/home/vagrant/saleem_setup_118" => "/home/#{ssh_user}/adb_mount"}
#  config.sshfs.host_addr = '127.0.0.1'
#  config.sshfs.host_port = '10022'
#  config.sshfs.prompt_create_folders = true
#  config.sshfs.sudo = false
#  config.ssh.insert_key = 'true'
#  config.ssh.forward_agent = 'true'
#  config.sshfs.password_prompt = true
#
#  # config.sshfs.enabled = false
#  # config.vm.synced_folders

end
